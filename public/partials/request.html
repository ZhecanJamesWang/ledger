
<!-- public/partials/request.html -->

<div class=".container-fluid">
  <form name="requestForm" class="col-md-8 col-md-offset-2" ng-submit="processForm()" novalidate>  
      <!-- Alerts indicating the result of a requested operation -->
    <uib-alert 
        ng-repeat="alert in alerts"
        type="{{alert.type}}"
        close="dismissAlert($index)">
      {{alert.msg}}
    </uib-alert>

    <div class="col-md-4">
      <label >Type</label>
    </div>
  
    <div 
        class="form-group"
        ng-class="{valid:'has-success has-feedback',
            invalid:'has-error has-feedback',
            empty:''}[type.validation.isValid]">
  <!-- <span class="input-group-addon">Organization</span> -->
      <select class="form-control" name="type" ng-model= "type.value" ng-focus="type.validate()" ng-blur="type.validate()" ng-click="type.validate()" required>
        <option value="expense">Expense</option>
        <option value="transfer">Transfer</option>
        <option value="revenue">Revenue</option>
      </select>
      <span
          ng-if="type.validation.isValid == 'invalid'"
          class="help-block">
        {{type.validation.helpBlock}}
      </span>
    </div>

    <div class="col-md-4">
      <label >Organization</label>
    </div>
    <!-- 
    <div ng-repeat="org in orgs" >
      <option value="org.name">{{org.name}}</option>
    </div>
 -->
    <div 
        class="form-group"
        ng-class="{valid:'has-success has-feedback',
            invalid:'has-error has-feedback',
            empty:''}[organization.validation.isValid]">

      <!-- <span class="input-group-addon">Organization</span> -->
      <select class="form-control" name="organization" ng-model= "organization.value" ng-focus="organization.validate()" ng-blur="organization.validate()" ng-click="organization.validate()" required>
        <option ng-repeat="org in orgs" value = "{{org.name}}">{{org.name}}</option>
      </select>
      <span
          ng-if="organization.validation.isValid == 'invalid'"
          class="help-block">
        {{organization.validation.helpBlock}}
      </span>
    </div>

    <div class="col-md-4">
      <label >Description</label>
    </div>
    <div 
        class="form-group" 
        ng-class="{valid:'has-success has-feedback',
            invalid:'has-error has-feedback',
            empty:''}[description.validation.isValid]">
      <!-- ng-click = "validate()" -->

      <!-- <input type="text" class="form-control" placeholder="< 100 words" aria-describedby="basic-addon1" ng-model = description> -->
      <input type="text" name="description" class="form-control" placeholder="< 100 words" aria-describedby="basic-addon1" ng-model = "description.value"  ng-blur="description.validate()" required>
      <span
          ng-if="description.validation.isValid == 'valid'"
          class="requestGlyphicon glyphicon glyphicon-ok form-control-feedback"
          aria-hidden="true"></span>
      <span
          ng-if="description.validation.isValid == 'invalid'"
          class="requestGlyphicon glyphicon glyphicon-remove form-control-feedback"
          aria-hidden="true"></span>
      <!-- </input> -->
      <span
          ng-if="description.validation.isValid == 'invalid'"
          class="help-block">
        {{description.validation.helpBlock}}
      </span>
<!--       <div ng-messages="requestForm.description.$error">
        <div class = "help-block" ng-message="required">This field is required</div>
      </div> -->
    </div>

    <div class="col-md-4">
      <label >Details</label>
    </div>

    <div 
      class="form-group"
      ng-class="{valid:'has-success has-feedback',
            invalid:'has-error has-feedback',
            empty:''}[details.validation.isValid]">

      <input type="text" name="details" class="form-control" placeholder="< 200 words" aria-describedby="basic-addon1" ng-model = "details.value" 
      ng-blur="details.validate()" required/>
      <span
          ng-if="details.validation.isValid == 'valid'"
          class="requestGlyphicon glyphicon glyphicon-ok form-control-feedback"
          aria-hidden="true"></span>
      <span
          ng-if="details.validation.isValid == 'invalid'"
          class="requestGlyphicon glyphicon glyphicon-remove form-control-feedback"
          aria-hidden="true"></span>
      <span
          ng-if="details.validation.isValid == 'invalid'"
          class="help-block">
        {{details.validation.helpBlock}}
      </span>
    </div>

    <div ng-class="{valid:'has-success has-feedback',
            invalid:'has-error has-feedback',
            empty:''}[amount.validation.isValid]">

      <div class="col-md-4">
        <label >Amount</label>
      </div>

      <div class="form-group input-group">
        <span class="input-group-addon">$</span>
        <input type="number" name = "amount" class="form-control" placeholder="< 200 $" aria-label="Amount (to the nearest dollar)" ng-model = "amount.value" ng-blur="amount.validate()" required/>
      <!--   <span
          <span class="input-group-addon">.00</span> -->
      </div>
      <span
          ng-if="amount.validation.isValid == 'invalid'"
          class="col-md-8 col-md-offset-4 help-block">
        {{amount.validation.helpBlock}}
      </span>
    </div>


    <div class = "row">
      <label class="col-md-4">Specification</label>
    </div>

   
        <div  class = "form-group row" ng-repeat="item in items">
           <div 
            class = "specification" 
            ng-class="{valid:'has-success has-feedback',
                    invalid:'has-error has-feedback',
                    empty:''}[item.validation.isValid]">
                <div class="col-md-4" >
                  <div class="input-group">
                        <span class="input-group-addon">Item</span>
                        <input name = "itemName" type="text" class="form-control"  ng-model = item.name ng-blur="validateItem (item.index)" required/>
                  </div>
                </div>

                <div class="col-md-4">
                  <div class="input-group">
                    <span class="input-group-addon">Price</span>
                    <input name = "itemPrice" type="number" class="form-control" ng-model = item.price ng-blur="validateItem (item.index)" required>
                  </div>
                </div>

                <div class="col-md-3">
                  <div class="input-group">
                    <select name = "itemCategory" class="form-control" ng-focus="validateItem(item.index)" ng-blur="validateItem (item.index)" ng-click="validateItem (item.index)" ng-model= item.category required>

                      <option value="Food">Food</option>
                      <option value="Equipment">Equipment</option>
                      <option value="Stationary">Stationary</option>
                      <option value="Dangerous Stuff">Dangerous Stuff</option>
                    </select>
                  </div>
                </div>
                <div class = "col-md-1 vcenter">
                  <span class="glyphicon glyphicon-remove" aria-hidden="true" ng-click="delItem(item.index)"></span>
                </div>
                <span
                    ng-if="item.validation.isValid == 'invalid'"
                    class="col-md-8 col-md-offset-4 help-block">
                  {{item.validation.nameHelpBlock}}
                  {{item.validation.priceHelpBlock}}
                  {{item.validation.categoryHelpBlock}}
                </span>
          </div>
        </div>
         
        <div class="btn-toolbar">
          <button type="button" class='btn btn-default' ng-click="addItem()">Add Item</button>
          <!-- <button type="button" class='btn btn-default' ng-click="delItem()">Delete Item</button>  -->
        </div>


    <div class="checkbox">
      <label>
        <input type="checkbox" ng-model="onlineCheck">
        <Strong>If Online</Strong>
      </label>
    </div>
    
    <div class = "onlineSpecification" ng-show = "onlineCheck"> 
      
      <div ng-repeat="link in links" class = "form-group row">
        <div ng-class="{valid:'has-success has-feedback',
                    invalid:'has-error has-feedback',
                    empty:''}[link.validation.isValid]">
          <div class="col-md-5" >
            <div class="input-group">
                  <span class="input-group-addon">Link</span>
                  <input name = "linkURL" type="text" class="form-control" ng-model = link.url ng-blur="validateLink (link.index)" required>
            </div>
          </div>

          <div class="col-md-6">
            <div class="input-group">
              <span class="input-group-addon">Description</span>
              <input name = "linkDsp" type="text" class="form-control" ng-model = link.description ng-blur="validateLink (link.index)" required>
            </div>
          </div>
          <div class = "col-md-1 vcenter">
            <span class="glyphicon glyphicon-remove" aria-hidden="true" ng-click="delLink(link.index)"></span>
          </div>
          <span
            ng-if="link.validation.isValid == 'invalid'"
            class="col-md-8 col-md-offset-4 help-block">
            {{link.validation.urlHelpBlock}}
            {{link.validation.dspHelpBlock}}
          </span>
        </div>  
      </div>

      <div class="btn-toolbar">
        <button type="button" class='btn btn-default' ng-click="addLink()">Add Item</button>
        <!-- <button type="button" class='btn btn-default' ng-click="delLink()">Delete Item</button>  -->
      </div>

    </div>

    <div class="request-form-submit">
      <button type="submit" class='btn btn-success btn-lg btn-block' >Submit</button> 
    </div>
    
  </form>
</div>




