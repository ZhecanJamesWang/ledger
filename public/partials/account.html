<!--
File: public/partials/account.html
Description: Describes the user account page which displays user profile
    information and allows users to change their account information.
-->

<!-- Alerts indicating the result of a requested operation appear at the top -->
<uib-alert 
    ng-repeat="alert in alerts"
    type="{{alert.type}}"
    close="dismissAlert($index)">
  {{alert.msg}}
</uib-alert>

<!-- The actual account settings information -->

<h1>Account Settings</h1>
<hr>

<!-- The username is unique to each user and cannot be edited -->
<div class="row">
  <div class="col-xs-9">
    <div class="row">
      <label class="col-sm-3">Username</label>
      <div class="col-sm-9">
        <p>{{user.username}}</p>
      </div>
    </div>
  </div>
</div>
<hr>

<!-- Display and allow users to edit their real name -->
<div class="row">
  <div class="col-xs-9">
    <div class="row">
      <label class="col-sm-3">Name</label>
      <div class="col-sm-9">
        <p>{{user.name}}</p>
      </div>
    </div>
  </div>
  <div class="col-xs-3">
    <button
        type="button"
        class="btn btn-default pull-right"
        ng-click="nameEditor.isCollapsed = !nameEditor.isCollapsed"
        ng-disabled="!nameEditor.isCollapsed">
      Edit
    </button>
  </div>
</div>

<!-- Collapsable name editing form -->
<div
    uib-collapse="nameEditor.isCollapsed"
    class="panel panel-default margin-top-10">
  <div class="panel-heading">Edit Name</div>
  <div class="panel-body">
    <form role="form" autocomplete="off" name="nameForm">
      <div class="form-group row">
        <label
            for="inputName"
            class="col-sm-2
            form-control-label">
          New name
        </label>
        <div class="col-sm-10">
          <div
              class="form-group"
              ng-class="{valid:'has-success has-feedback',
                  invalid:'has-error has-feedback',
                  empty:''}[newName.validation.isValid]">
            <input
                name="name"
                id="inputName"
                type="text"
                class="form-control"
                placeholder="Joe Student"
                autocomplete="off"
                ng-model="newName.value"
                ng-blur="newName.validate()"
                required>
            <span
                ng-if="newName.validation.isValid == 'valid'"
                class="glyphicon glyphicon-ok form-control-feedback"
                aria-hidden="true"></span>
            <span
                ng-if="newName.validation.isValid == 'invalid'"
                class="glyphicon glyphicon-remove form-control-feedback"
                aria-hidden="true"></span>
            <span
                ng-if="newName.validation.isValid == 'invalid'"
                class="help-block">
              {{newName.validation.helpBlock}}
            </span>
          </div> <!-- .form-group -->
        </div> <!-- .col-sm-10 --> 
      </div> <!-- .form-group .row -->
      <button
          type="button"
          class="btn btn-default pull-right"
          ng-click="closeEditName()">
        Cancel
      </button>
      <button
          type="button"
          class="btn btn-default pull-right"
          ng-click="saveEditName()">
        Save
      </button>
    </form>
  </div>
</div>
<hr>

<!-- Display and allow users to edit their email address -->
<div class="row">
  <div class="col-xs-9">
    <div class="row">
      <label class="col-sm-3">Email</label>
      <div class="col-sm-9">
        <p>{{user.email}}</p>
      </div>
    </div>
  </div>
  <div class="col-xs-3">
    <button
        type="button"
        class="btn btn-default pull-right"
        ng-click="emailEditor.isCollapsed = !emailEditor.isCollapsed"
        ng-disabled="!emailEditor.isCollapsed">
      Edit
    </button>
  </div>
</div>

<!-- Collapsable email editing form -->
<div
    uib-collapse="emailEditor.isCollapsed"
    class="panel panel-default margin-top-10">
  <div class="panel-heading">Edit Email</div>
  <div class="panel-body">
    <form role="form" autocomplete="off" name="emailForm">
      <div class="form-group row">
        <label
            for="inputEmail"
            class="col-sm-2
            form-control-label">
          New email
        </label>
        <div class="col-sm-10">
          <div
              class="form-group"
              ng-class="{valid:'has-success has-feedback',
                  invalid:'has-error has-feedback',
                  empty:''}[newEmail.validation.isValid]">
            <input
                name="email"
                id="inputEmail"
                type="email"
                class="form-control"
                placeholder="Joe.Student@students.olin.edu"
                autocomplete="off"
                ng-model="newEmail.value"
                ng-blur="newEmail.validate()"
                required>
            <span
                ng-if="newEmail.validation.isValid == 'valid'"
                class="glyphicon glyphicon-ok form-control-feedback"
                aria-hidden="true"></span>
            <span
                ng-if="newEmail.validation.isValid == 'invalid'"
                class="glyphicon glyphicon-remove form-control-feedback"
                aria-hidden="true"></span>
            <span
                ng-if="newEmail.validation.isValid == 'invalid'"
                class="help-block">
              {{newEmail.validation.helpBlock}}
            </span>
          </div> <!-- .form-group -->
        </div> <!-- .col-sm-10 --> 
      </div> <!-- .form-group .row -->
      <button
          type="button"
          class="btn btn-default pull-right"
          ng-click="closeEditEmail()">
        Cancel
      </button>
      <button
          type="button"
          class="btn btn-default pull-right"
          ng-click="saveEditEmail()">
        Save
      </button>
    </form>
  </div>
</div>
<hr>

<!-- Do not display a users password, but allow them to edit it -->
<div class="row">
  <div class="col-xs-9">
    <div class="row">
      <label class="col-sm-3">Password</label>
      <div class="col-sm-9">
        <p>&#9679;&#9679;&#9679;&#9679;&#9679;&#9679;&#9679;&#9679;</p>
      </div>
    </div>
  </div>
  <div class="col-xs-3">
    <button
        type="button"
        class="btn btn-default pull-right"
        ng-click="passwordEditor.isCollapsed = !passwordEditor.isCollapsed"
        ng-disabled="!passwordEditor.isCollapsed">
      Edit
    </button>
  </div>
</div>
<hr>

<!-- Collapsable password editing form -->
<div
    uib-collapse="passwordEditor.isCollapsed"
    class="panel panel-default margin-top-10">
  <div class="panel-heading">Edit Password</div>
  <div class="panel-body">
    <form role="form" autocomplete="off" name="passwordForm">
      <div class="form-group row">
        <label
            for="inputCurrentPassword"
            class="col-sm-2
            form-control-label">
          Current password
        </label>
        <div class="col-sm-10">
          <div
              class="form-group"
              ng-class="{valid:'has-success has-feedback',
                  invalid:'has-error has-feedback',
                  empty:''}[currentPassword.validation.isValid]">
            <input
                name="currentPassword"
                id="inputCurrentPassword"
                type="password"
                class="form-control"
                placeholder="current password"
                autocomplete="new-password"
                ng-model="currentPassword.value"
                ng-blur="currentPassword.clearValidation()"
                required>
            <span
                ng-if="currentPassword.validation.isValid == 'valid'"
                class="glyphicon glyphicon-ok form-control-feedback"
                aria-hidden="true"></span>
            <span
                ng-if="currentPassword.validation.isValid == 'invalid'"
                class="glyphicon glyphicon-remove form-control-feedback"
                aria-hidden="true"></span>
            <span
                ng-if="currentPassword.validation.isValid == 'invalid'"
                class="help-block">
              {{currentPassword.validation.helpBlock}}
            </span>
          </div> <!-- .form-group -->
        </div> <!-- .col-sm-10 --> 
      </div> <!-- currentPassword .form-group .row -->

      <div class="form-group row">
        <label
            for="inputNewPassword"
            class="col-sm-2
            form-control-label">
          New password
        </label>
        <div class="col-sm-10">
          <div
              class="form-group"
              ng-class="{valid:'has-success has-feedback',
                  invalid:'has-error has-feedback',
                  empty:''}[newPassword.validation.isValid]">
            <input
                name="newPassword"
                id="inputNewPassword"
                type="password"
                class="form-control"
                placeholder="new password"
                autocomplete="new-password"
                ng-model="newPassword.value"
                ng-blur="newPassword.validate()"
                required>
            <span
                ng-if="newPassword.validation.isValid == 'valid'"
                class="glyphicon glyphicon-ok form-control-feedback"
                aria-hidden="true"></span>
            <span
                ng-if="newPassword.validation.isValid == 'invalid'"
                class="glyphicon glyphicon-remove form-control-feedback"
                aria-hidden="true"></span>
            <span
                ng-if="newPassword.validation.isValid == 'invalid'"
                class="help-block">
              {{newPassword.validation.helpBlock}}
            </span>
          </div> <!-- .form-group -->
        </div> <!-- .col-sm-10 --> 
      </div> <!-- newPassword .form-group .row -->

      <div class="form-group row">
        <label
            for="inputConfirmNewPassword"
            class="col-sm-2
            form-control-label">
          Confirm new password
        </label>
        <div class="col-sm-10">
          <div
              class="form-group"
              ng-class="{valid:'has-success has-feedback',
                  invalid:'has-error has-feedback',
                  empty:''}[confirmNewPassword.validation.isValid]">
            <input
                name="confirmNewPassword"
                id="inputConfirmNewPassword"
                type="password"
                class="form-control"
                placeholder="new password"
                autocomplete="new-password"
                ng-model="confirmNewPassword.value"
                ng-blur="confirmNewPassword.validate()"
                required>
            <span
                ng-if="confirmNewPassword.validation.isValid == 'valid'"
                class="glyphicon glyphicon-ok form-control-feedback"
                aria-hidden="true"></span>
            <span
                ng-if="confirmNewPassword.validation.isValid == 'invalid'"
                class="glyphicon glyphicon-remove form-control-feedback"
                aria-hidden="true"></span>
            <span
                ng-if="confirmNewPassword.validation.isValid == 'invalid'"
                class="help-block">
              {{confirmNewPassword.validation.helpBlock}}
            </span>
          </div> <!-- .form-group -->
        </div> <!-- .col-sm-10 --> 
      </div> <!-- confirmNewPassword .form-group .row -->
      <button
          type="button"
          class="btn btn-default pull-right"
          ng-click="closeEditPassword()">
        Cancel
      </button>
      <button
          type="button"
          class="btn btn-default pull-right"
          ng-click="saveEditPassword()">
        Save
      </button>
    </form>
  </div>
</div>